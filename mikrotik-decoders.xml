<decoder name="MikroTik-Identity-Change">
        <prematch type="pcre2">^system identity changed by</prematch>
        <regex type="pcre2">^system identity changed by\s+(.+?):(\S+)@([0-9\.]+)\s+\(\/system identity set name=([^)]+)\)</regex>
        <order>method, username, srcip, new_identity</order>
</decoder>


<decoder name="MikroTik-Time-Change">
        <prematch type="pcre2">^change time</prematch>
        <regex type="pcre2">^change time\s+(.+?)\s+=>\s+(.+)$</regex>
        <order>old_time, new_time</order>
</decoder>


<decoder name="MikroTik-Timezone-Change">
        <prematch type="pcre2">^system time zone settings changed by</prematch>
        <regex type="pcre2">^system time zone settings changed by\s+(.+?):(\S+)@([0-9\.]+).*time-zone-name=([^;\s]+)</regex>
        <order>method, username, srcip, timezone</order>
</decoder>

<decoder name="MikroTik-VPN-Login">
        <prematch type="pcre2">logged in,</prematch>
        <regex type="pcre2">^(\S+)\s+logged in,\s+([0-9\.]+)\s+from\s+([0-9\.]+)$</regex>
        <order>username, localip, srcip</order>
</decoder>

<decoder name="MikroTik-VPN-Auth-Failed">
        <prematch type="pcre2">authentication failed</prematch>
        <regex type="pcre2">^(?:&lt;([0-9\.]+)&gt;:)?\s*user\s+(\S+)\s+authentication\s+failed</regex>
        <order>srcip, username</order>
</decoder>

<decoder name="MikroTik-VPN-Logout">
        <prematch type="pcre2">logged out,</prematch>
        <regex type="pcre2">^(\S+)\s+logged out,.*from\s+([0-9\.]+)$</regex>
        <order>username, srcip</order>
</decoder>

<decoder name="MikroTik-Failed-User-Login">
        <prematch type="pcre2">login failure</prematch>
        <regex type="pcre2">login failure for user (\S+) from (\S+) via (\S+)</regex>
        <order>username, srcip, method</order>
</decoder>

<decoder name="MikroTik-Successful-User-Login">
        <prematch type="pcre2">logged in from</prematch>
        <regex type="pcre2">user (\S+) logged in from (\S+) via (\S+)</regex>
        <order>username, srcip, method</order>
</decoder>

<decoder name="MikroTik-User-Logout">
        <prematch type="pcre2">logged out from</prematch>
        <regex type="pcre2">user (\S+) logged out from (\S+) via (\S+)</regex>
        <order>username, srcip, method</order>
</decoder>

<decoder name="MikroTik-User-Change">
        <prematch type="pcre2">^user\s+\S+\s+(added|changed)\s+by\s+</prematch>
        <regex type="pcre2">^user\s+(\S+)\s+(added|changed)\s+by\s+([^:/\s]+)(?:-[^/]+)?/tcp-msg\(winbox\):(\S+)@([0-9\.]+).*disabled=(yes|no).*group=([a-zA-Z]+)</regex>
        <order>target_user, action, method, admin_user, srcip, disabled, group</order>
</decoder>

<decoder name="MikroTik-IPv4-Filter-Rule-Change">
        <prematch type="pcre2">^filter rule\s+(added|changed)\s+by\s+</prematch>
        <regex type="pcre2">^filter rule\s+(added|changed)\s+by\s+([^:/\s]+)(?:-[^/]+)?/tcp-msg\(winbox\):(\S+)@([0-9\.]+).*action=([a-zA-Z]+).*chain=([a-zA-Z]+).*disabled=(yes|no)</regex>
        <order>event_action, method, username, srcip, fw_action, chain, disabled</order>
</decoder>

<decoder name="MikroTik-IPv4-Filter-Rule-Removed">
        <prematch type="pcre2">^filter rule\s+removed\s+by\s+</prematch>
        <regex type="pcre2">^filter rule\s+removed\s+by\s+([^:/\s]+)(?:-[^/]+)?/tcp-msg\(winbox\):(\S+)@([0-9\.]+)</regex>
        <order>method, username, srcip</order>
</decoder>


<decoder name="MikroTik-IPv6-Filter-Rule-Change">
        <prematch type="pcre2">^filter6 rule\s+(added|changed)\s+by\s+</prematch>
        <regex type="pcre2">^filter6 rule\s+(added|changed)\s+by\s+([^:/\s]+)(?:-[^/]+)?/tcp-msg\(winbox\):(\S+)@([0-9\.]+).*action=([a-zA-Z]+).*chain=([a-zA-Z]+).*disabled=(yes|no)</regex>
        <order>event_action, method, username, srcip, fw_action, chain, disabled</order>
</decoder>

<decoder name="MikroTik-IPv6-Filter-Rule-Removed">
        <prematch type="pcre2">^filter6 rule\s+removed\s+by\s+</prematch>
        <regex type="pcre2">^filter6 rule\s+removed\s+by\s+([^:/\s]+)(?:-[^/]+)?/tcp-msg\(winbox\):(\S+)@([0-9\.]+)</regex>
        <order>method, username, srcip</order>
</decoder>

<decoder name="MikroTik-User-Password-Change">
        <prematch type="pcre2">^user\s+\S+\s+password\s+changed</prematch>
        <regex type="pcre2">^user\s+(\S+)\s+password\s+changed\s+by\s+(\S+)</regex>
        <order>target_user, admin_user</order>
</decoder>

<decoder name="MikroTik-IP-Service-Change">
		<prematch type="pcre2">^ip service changed by</prematch>
		<regex type="pcre2">^ip service changed by\s+\S+/tcp-msg\((\w+)\):(\S+)@([0-9.]+)\s+\(\/ip service set\s+(\S+)\s+address=("?"[^"]*"?)\s+disabled=(yes|no)\s+max-sessions=(\d+)\s+port=(\d+)\s+vrf=(\S+)\)</regex>
		<order>method, admin_user, srcip, service, address, disabled, max_sessions, port, vrf</order>
</decoder>


<decoder name="MikroTik-DNS-Change">
        <prematch type="pcre2">^dns changed by\s+</prematch>
        <regex type="pcre2">^dns changed by\s+([^:/\s]+)(?:-[^/]+)?/tcp-msg\(winbox\):(\S+)@([0-9\.]+).*allow-remote-requests=(yes|no).*max-udp-packet-size=([0-9]+).*servers=([^ \)]+).*vrf=([a-zA-Z0-9_-]+)</regex>
        <order>method, admin_user, srcip, allow_remote, max_udp_size, servers, vrf</order>
</decoder>

<decoder name="MikroTik-Script-Added">
        <prematch type="pcre2">^new script added by winbox</prematch>
        <regex type="pcre2">^new script added by winbox-[^/]+/tcp-msg\(winbox\):(\S+)@([0-9\.]+)</regex>
        <order>admin_user, srcip</order>
</decoder>

<decoder name="MikroTik-Script-Removed">
        <prematch type="pcre2">^script removed by winbox</prematch>
        <regex type="pcre2">^script removed by winbox-[^/]+/tcp-msg\(winbox\):(\S+)@([0-9\.]+)</regex>
        <order>admin_user, srcip</order>
</decoder>

             
